{% extends "report____/layout.html" %}

{% block report____title_block %}
  {{ report.name }}
{% endblock %}

{% block report____customized_head_block %}
  <link href="http://cdn.bootcss.com/datatables/1.10.1/css/jquery.dataTables.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="{{ url_for('report____.static', filename='css/report.css') }}">
  <script src="http://cdn.bootcss.com/datatables/1.10.1/js/jquery.dataTables.min.js"></script>
  <script src="http://cdn.bootcss.com/sprintf/1.0.2/sprintf.min.js"></script>
  <script src="{{ url_for('report____.static', filename='js/report.js') }}"></script>
{% endblock %}

{% block body %}
  <div class="panel-group">
    <div class="panel panel-info">
      <div class="panel-heading">
        <h1 class="panel-title">
          {{ report.name }}
          <small>
            <a href="#" data-toggle="collapse" data-target="#detail" class="text-muted">{{ _('show detail') }}
              >></a>
          </small>
        </h1>
      </div>
      <div id="detail" class="panel-collapse collapse">
        <p>
          <small>{{ report.description +"<br>"|safe if report.description else "" }}{{ gettext('created by "%(creator)s" at %(create_time)s, using data set <a href="%(url)s" title="%(data_set_description)s">"%(data_set)s"</a>',
      creator=report.creator, create_time=report.create_time,
      data_set_description=report.data_set.description or "",
      url=url_for(".data_set", id_=report.data_set.id_),
      data_set=report.data_set.name) }}
            {{ _('filter conditions are: ') }}
          </small>
        </p>
        <ul>
          {% if report.filters %}
            {% for name, value in report.filters.items() %}
              <li>
                <small>
                  <Strong>{{ name }}</Strong> - {{ value|dpprint }}
                </small>
              </li>
            {% endfor %}
          {% endif %}
        </ul>
        <p>
          <small>
            {{ _("the customized filter condition is: ") }}
          </small>
        </p>
        <p>
          {{ customized_filter_condition|safe }}
        </p>
        {% if SQL %}
          <small>
            <div>{{ _("SQL statement") }}:</div>
            <p>
              {{ SQL|safe }}
            </p>
          </small>
        {% endif %}
        <p>
          <small></small>
        </p>
      </div>
    </div>
  </div>
  <hr/>
  <div class="col-lg-12">
    {{ html_report|safe }}
  </div>
  <hr/>

  <div class="col-lg-12">
    {{ _("download as: ") }}
    <div class="btn-group">
      <a href="{{ url_for('.report_pdf', id_=report.id_) }}" class="btn btn-primary btn-info">PDF</a>
      <a href="{{ url_for('.report_csv', id_=report.id_) }}" class="btn btn-primary btn-info">CSV</a>
      {#    <a href="{{ url_for('.report_txt', id_=report.id_) }}" class="btn btn-primary btn-info">TXT</a>#}
    </div>

  {% if report.bar_charts or report.pie_charts %}
    <a href="{{ url_for(".report_graphs", id_=report.id_, url=request.url) }}" class="btn btn-default">
      <i class="fa fa-bar-chart-o fa-fw"></i>
      {{ _("View Graphs") }}
    </a>
  {% endif %}
  </div>
  <hr/>

  <div class="col-lg-12">
    <div class="center-block text-center">
      {% if not request.args.get('preview') %}
        <a href="{{ request.args.get("url", url_for('.report_list')) }}" class="btn btn-default btn-lg">{{ _('BACK') }}</a>
      {% endif %}
      <!--<a href="" class="btn btn-primary btn-lg">{{ _('EDIT') }}</a>-->
      <a href="" class="btn btn-primary btn-lg">{{ _('REFRESH') }}</a>
    </div>
  </div>

  {% block drill_down %}
    <div id="drill-down-detail" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h3></h3>
          </div>
          <div class="modal-body">
            <p>
            </p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-default" data-dismiss="modal" aria-hidden="true">{{ _('Close') }}</button>
          </div>
        </div>
      </div>
    </div>
  {% endblock %}
{% endblock %}
