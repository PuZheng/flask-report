{% extends "report____/layout.html" %}

{% block report____title_block %}
  {{ report.name }}
{% endblock %}

{% block report____customized_head_block %}
<link rel="stylesheet" type="text/css" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="{{ url_for('report____.static', filename='DT_bootstrap.js') }}"></script>
<script type="text/javascript">
  $.extend( $.fn.dataTableExt.oStdClasses, {
      "sWrapper": "dataTables_wrapper form-inline"
  });
  $(function () {
      $("#report").dataTable({
        "oLanguage": {
          "sSearch": "搜索: ",
            "sLengthMenu": "每页展示_MENU_条记录",
            "sZeroRecords": "对不起，找不到数据",
            "sInfo": "共有_TOTAL_条数据，展示了其中_START_到_END_条",
            "sInfoEmpty": "共0条数据",
            "sInfoFiltered": "从_MAX_条记录中过滤产生",
            'oPaginate': {
              "sPrevious": "上一页",
              "sNext": "下一页",
              "sFirst": "首页",
              'sLast': '末页',
              },
            },
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "iDisplayLength": 25,
        });
      $("#detail").on('shown', function () {
        $('a[data-target="#detail"]').text("{{ _('hide detail') }}" + " <<");
        });
      $("#detail").on('hidden', function () {
        $('a[data-target="#detail"]').text("{{ _('show detail') }}" + " >>");
        });
      });
</script>
{% endblock %}

{% block body %}
<div class="container">
<div class="alert alert-info">
  <h1>
  <span>
    {{report.name}}
    <small>
      <a href="#" data-toggle="collapse" data-target="#detail" class='muted'>{{ _('show detail') }} >></a>
    </small>
  </span>
  </h1>
  <div id="detail" class="collapse">
  <p><small>{{ _('created by "%(creator)s" at %(create_time)s, using data set "%(data_set)s", ', 
    creator=report.creator, create_time=report.creat_time, 
    data_set=report.data_set.name) }}
    {% if report.order_by %}
      {{ _('order by "%(order_by)s" %(order)s',
        order_by=report.order_by.name, 
        order=_('descendingly') if report.order_by.descend else _('ascendingly'))
      }}
    {% endif %}; 
    {{ _('filter conditions are: ') }}
  </small></p>
  <ul>
    {% if report.filters %}
    {% for name, value in report.filters.items() %}
    <li>
    <small>
      <Strong>{{ name }}</Strong> - {{ value }}
    </small>
    </li>
    {% endfor %}
    {% endif %}
  </ul>
  <p>
    <small>
      {{ _("the customized filter condition is: ") }} 
    </small>
  </p>
  <p>
    {{ customized_filter_condition|safe }}
  </p>
</div>
</div>
<hr />
<div>
{{ html_report|safe }}
</div>
<hr />

<span class='span-12'>
  {{ _("download as: ")}}
  <div class="btn-group pagination-centered">
    <a href="{{ url_for('.report_pdf', id_=report.id_) }}" class="btn btn-primary btn-info">PDF</a>
    <a href="{{ url_for('.report_csv', id_=report.id_) }}" class="btn btn-primary btn-info">CSV</a>
    <a href="{{ url_for('.report_txt', id_=report.id_) }}" class="btn btn-primary btn-info">TXT</a>
  </div>
</span>
<div class="pagination-centered span12">
  <a href="{{ url_for('.report_list') }}" class="btn btn-primary btn-large">{{ _('BACK') }}</a>
  <a href="" class="btn btn-primary btn-large">{{ _('EDIT') }}</a>
  <a href="" class="btn btn-primary btn-large">{{ _('REFRESH') }}</a>
</div>
</div>
{% endblock %}
